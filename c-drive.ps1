Get-ChildItem 'c:\windows' -recurse |where {$_.attributes -notMatch "Directory"}|Select-Object Directory, BaseName, Extension,@{Name="LastWriteTime";Expression= {"{0:yyyy}-{0:MM}-{0:dd} {0:hh}:{0:mm}:{0:ss}" -f ([DateTime]$_.LastWriteTime)}},@{Name="CreationTime";Expression= {"{0:yyyy}-{0:MM}-{0:dd} {0:hh}:{0:mm}:{0:ss}" -f ([DateTime]$_.CreationTime)}},@{Name="LastAccessTime";Expression= {"{0:yyyy}-{0:MM}-{0:dd} {0:hh}:{0:mm}:{0:ss}" -f ([DateTime]$_.LastAccessTime)}},Length, @{Name="Owner";Expression={(Get-Acl $_.FullName).Owner }} |Export-Csv C:\Temp\c-drive.csv -encoding "unicode"-notype -Delimiter ";"
